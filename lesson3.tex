%!TEX root = main.tex
\chapter{Komplexe Zahlen} \label{chap:complex}
\index{Komplexe Zahlen}

Komplexe Zahlen haben äußerst große Wichtigkeit in der Beschreibung von Harmonischen Schwingungen und daher natürlich ebensolche Relevanz in der Audio Domäne. \\
\todo[inline]{Beispiele}

Beim Versuch ein einfaches Polynom auf Nullstellen zu untersuchen stoßen wir auf Probleme: $p(x) = x^2 + 1$. Wir suchen die Nullstellen durch einsetzen und Umformen:

$$0 = x^2 + 1$$
$$-1 = x^2$$
$$\sqrt{-1} = x$$

\important{
Dies führt uns auf die Definition einer neuen 'Zahl', der imaginären Einheit, $i$.
\begin{equation}
i = \sqrt{-1}
\end{equation}
}

Dies erlaubt die Lösung des obigen Polynoms: $x = \pm i$. Es ist nachvollziehbar wenn sich das nach einem dummen 'Trick' anfühlt an dieser Stelle. Historisch war die Etablierung dieser Zahl und der daraus resultierenden Komplexen Zahlen nicht unumstritten. Es wird in Abschnitt \ref{sec:anwendungen} versucht, die praktische Seite dieser Einführung unbestreitbar zu machen. \\
\important{
Nun kann der Zahlenkörper der Komplexen Zahlen $\mathbb{C}$ wie folgt beschrieben werden:
Die Menge der Elemente in $\mathbb{R}^2$, also der Zahlenpaare $(a,b)$ wobei $a$ und $b$ reelle Zahlen sind \citep{merziger2024repetitorium} und das Element $i:= (0,1)$. \\

Das Element $(a,b)$ kann zerlegt werden:
$(a,b) = (a,0) + (0,b) = a+bi$
Daher wird 
\begin{itemize}
	\item$a$ \textbf{Realteil} und 
	\item $b$ \textbf{Imaginärteil} genannt.
\end{itemize}
}

\section{Darstellung}
\index{Kartesische Darstellung}
Komplexe zahlen können auf verschiedene Arten dargestellt werden. Vielleicht darf dies metaphorisch mit unterschiedlichen Darstellungen von Dezimalzahlen verglichen werden (die Ziffern $10$ in Binärsystem entsprechen dem wert des Ausdrucks $2$ in Dezimalsystem). Die unterschiedlichen Darstellungen erlauben unterschiedliche Einsichten und manche Darstellungen vereinfachen bestimmte Operationen wie Multiplikation, Addition etc. 
Die üblicherweise als erstes Betrachtete Darstellung, ist die oben beschriebene\emph{Kartesische Darstellung}\footnote{Benannt nach René Descartes. 31. März 1596 – 11. Februar 1650.}:

\important{

\begin{equation}
z = a + bi
\end{equation}
}
\begin{figure}[h]
	\centering
	\input{python/plots/comp_cart01.pgf}
	\caption{Kartesische Darstellung der Komplexen Zahl $z = 2 + 3i$.}
	\label{fig:komp_kart}
\end{figure}

Unabhängig von der mathematischen 'Darstellung' - also Schreibweise - der Zahl kann sie als Punkt in einem zweidimensionalen Koordinatensystem visualisiert werden. Hier stellt die Abzisse den Realteil ($\Re$) und die Ordinate den Imaginärteil ($\Im$) dar, siehe Abbildung \ref{fig:komp_kart}. 

Vielleicht ist es einleuchtend dass wir den selben Punkt auf dieser \emph{Zahlenebene} nicht nur per 'x/y' Koordinaten darstellen können sondern alternativ via Radius $r$ und Winkel $\varphi$, siehe Abb. \ref{fig:komp_pol}.


\begin{figure}[h]
	\centering
	\input{python/plots/comp_polar.pgf}
	\caption{Polare Darstellung der Komplexen Zahl $z = 2 + 3i$.}
	\label{fig:komp_pol}
\end{figure}




\section{Rechenregeln für die Kartesische Darstellung}

Die Addition folgt der Vektoraddition, im wesentlichen dürfen Real- und Imaginärteil nicht 'vermischt' werden. Generell kann mit komplexen Zahlen wie mit reellen Zahlen gerechnet werden, nur dass eben auf $i$ Rücksicht genommen werden muss.
\begin{equation}
z_1 + z_2 = (a_1 + a_2) + i(b_1 + b_2)
\end{equation}


Die Multiplikation von Komplexen zahlen weicht ab vom Vergleich mit Vektoren:  
\begin{equation}\label{eq:cartMult}
z_1 \cdot z_2 = (a_1 a_2 - b_1 b_2)  + i(a_1 b_2 +a_2 b_1)
\end{equation}
Das mag verwirrend wirken, ist jedoch 1. sehr leicht herzuleiten und 2. ist es ein Vorteil der polaren Darstellung dass hier die Multiplikation wesentlich einfacher wird als eben hier in der Kartesischen. 

\begin{question}
    Leite Gleichung \ref{eq:cartMult} her aus den bis jetzt bekannten Prinzipien! 
\end{question}

\begin{answer}
$$(a_1 + b_1i) (a_2 + b_2i)$$
$$ = a_1a_2 + a_1b_2i + b_1i a_2 +b_1i b_2i$$
$$ = a_1a_2 +  a_1b_2i +b_1i a_2 - b_1 b_2 \qquad\text{ Da } ii = i^2 \text{ und } i^2=-1$$
$$ = a_1a_2 - b_1 b_2 + b_1i a_2 + a_1b_2i  \qquad\text{ Sammeln von real/imag}$$
$$ = a_1a_2 - b_1 b_2 +  i (b_1 a_2 + a_1b_2)$$
\end{answer}


\section{Konvertierung Zwischen Kartesischer und Polarer Darstellung}
Die Konvertierung folgt klassischen trigonometrischen Prinzipien.
Der Radius $r$ kann aus der Kartesischen Darstellung via Pythagoras berechnet werden:
\important{
$$r = \sqrt{a^2 + b^2}$$
$$ tan \varphi = \frac{b}{a}$$
}
Wenn man versucht die Umkehrfunktion des Tangens (Arkustangens, $arctan$) zu verwenden muss man beachten im richtigen Quadranten zu landen. Wenn $x<0$ muss $\pm \pi$ zum dem Ergebnis addiert werden. Daher ist in den meisten Programmiersprachen die Funktion \texttt{atan2} zu finden, die den Winkel Eindeutig berechnet (in Radianten). 

% \important{
$$|z| = r = \sqrt{a^2 + b^2}, \qquad \text{Wird Betrag genannt.}$$
$$ arg(z) = \varphi = atan2(b,a), \qquad \text{Wird Argument genannt.} $$



Umgekehrt kann $a$ und $b$ via Sinus und Kosinus berechnet werden:

$$a = r cos(\varphi)$$
$$b = r sin(\varphi)$$

\index{Polare Darstellung}
Hieraus ergibt sich schließlich die \textbf{Polare Darstellung}:
$$ z = r (cos(\varphi) + i sin(\varphi))$$
% }




\section{Eulersche Darstellung}

\index{Eulersche Formel}
\index{Eulersche Darstellung}
\index{Exponentialform}

Wohl eine der wichtigsten Gleichungen für die Audio Technik ist die Eulersche Formel:

\important{
\begin{equation}\label{eq:euler}
e^{xi} = cos(x) + isin(x)
\end{equation}
}

Aus Gleichung \ref{eq:euler} und der Polaren Darstellung leitet sich die 'Eulersche Darstellung' oder auch 'Exponentialform' für komplexe Zahlen ab:

\important{
\begin{equation}\label{eq:eulerNotation}
z = re^{i \varphi} 
\end{equation}
}

Dies ist wohl die Kompakteste und in vielen Fällen Praktischste Darstellung für unsere Zwecke. Sie findet sich zB. in der üblichen Schreibweise der Fourier Transformation und vielen anderen Ausdrücken unseres Feldes. \textbf{Aufgrund von Gleichung \ref{eq:euler} sollte uns klar sein dass der Ausdruck $e^{ix}$ (den wir oft vorfinden) immer als Sinus und Kosinus Schwingungen gedacht werden kann.}

\section{Rechenregeln in Eulerscher Darstellung}

Die Multiplikation zweier komplexer Zahlen in Eulerscher Darstellung wird durch Multiplikation der Radii und \emph{Addition} der Winkel ausgeführt:

\important{
$$z_1 \cdot z_2 = r_1e^{i\varphi_1} \cdot r_2e^{i\varphi_2} =  r_1 \cdot r_2 \cdot e^{i (\varphi_1 + \varphi_2)}$$}

Die komplexe Division ist 'gegenteilig' definiert: Beträge werden dividiert und Winkel subtrahiert:

$$\frac{z_1}{z_2} = \frac{r_1e^{i\varphi_1}} { r_2e^{i\varphi_2}} =  \frac{r_1}{ r_2} \cdot e^{i (\varphi_1 - \varphi_2)}$$


Potenzieren lässt sich aus der Multiplikation ableiten als: 
\important{
$$z ^n = (r e^{i\varphi})^n  = r^{n} e^{in\varphi} $$}

\praxis{In der Beschreibung digitaler Filter und Verzögerungen (Delays) werden üblicherweise Potenzen komplexer Zahlen verwendet ($z^{-1}$ entspricht einer Verzögerung um 1 Sample, siehe Abschnitt \ref{subsec:rationalExp}). Daher ist es natürlich sinnvoll Komfort mit komplexen Potenzen aufzubauen. }

So wie die Multiplikation in Kartesischer Darstellung wesentlich komplizierter wirkt als in Eulerscher Darstellung ist die Addition in Eulerscher Darstellung komplizierter als in Kartesischer und wir oft in Einführender Literatur Ausgespart.


\section{Konjugiert Komplexe Zahl}
\index{konjugiert komplex}
Gegeben $z_1 = a + bi$ wir die zahl $z_2 = a - bi = \overline{z_1}$\footnote{Die konjugiert konplexe Zahl von $z$ wird hier als $\overline{z}$ geschrieben. In der Literatur findet man auch $z^{*}$.} als konjugiert komplex bezeichnet. Oder in Exponentialform:
$$z = re^{\varphi i} \iff \overline{z} = re^{-\varphi i}$$

\begin{figure}[h]
	\centering
	\input{python/plots/comp_conju.pgf}
	\caption{Konjugiert komplexe zahl $\overline{z}$.}
	\label{fig:komp_conju}
\end{figure}


\section{Komplexe Division}
Oft macht man sich bei der Division von zwei komplexen Zahlen folgendes zunutze:
\begin{equation}
\frac{z_1}{z_2} = \frac{z_1 \cdot \overline{z_2}}{z_2 \cdot \overline{z_2}} 
\end{equation} 
Durch die Erweiterung mit der Komplex Konjugierten Zahle des Nenners lässt sich der Ausdruck oft vereinfachen da der Nenner hierdurch seinen Imaginärteil verliert.

\todo{Example}

\section{Komplexe Funktionen}
In der Audiotechnik sind komplexwertige Funktionen wichtig. Ein Beispiel wäre die Funktion $f(z) = z$ mit $z \in \mathbb{C}$. Ihr Betrag kann auf der Komplexen Ebene durch Farben dargestellt werden aber es ist auch manchmal hilfreich sich das Ergebnis als dreidimensionale Landschaft vorzustellen, siehe Abb. \ref{fig:komp_3D}. 

\begin{figure}[h]
	\centering
	\input{python/plots/comp_3d.pgf}
	\caption{Zwei Arten den Betrag einer Komplexen Zahl zu plotten.}
	\label{fig:komp_3D}
\end{figure}

\todo[inline]{Python beispiel um betrag zu plotten.}


\section{Komplexe Zahlen in Python}

In \texttt{Python} wird die Zahl $i$ durch \texttt{1j} ausgedrückt. \texttt{j} alleine hat zunächst keine Bedeutung und führt zu einer Fehlermeldung wenn \texttt{j} nicht definiert ist. \texttt{1j} hingegen ist $1\cdot i$, wobei \texttt{1} hier durch andere Zahlen ersetzt werden kann, zB \texttt{5j} ($=5\cdot i$) oder \texttt{2.7j}($=2.7 \cdot i$). Die folgende (ein wenig gekürzte) Aufzeichnung einer interaktiven \texttt{iPython} Session soll diesen vielleicht im ersten Moment verwirrenden Unterschied klar machen:

\begin{python}{Verwendung von $i$ in Python.}
In [1]: %pylab
In [2]: 1j
Out[2]: 1j
In [3]: j
NameError: name 'j' is not defined
In [4]: b = 3
In [5]: 2 + bj
NameError: name 'bj' is not defined
In [6]: 2 + b*1j
Out[6]: (2+3j)
\end{python}




\begin{question}

Gegeben $z = 4e^{3i}$, berechne $|z|$, $\angle z$, $\Re (z)$, $\Im (z)$, $\overline{z}$. Berechne ohne python aber nutze python um deine Ergebnisse zu bestätigen. Benutze die Numerischen Python Befehle in Tabelle \ref{tab:pyComNumeric}.
\end{question}


\begin{answer}
	Zunächst notieren wir auf dem Blatt Papier auf dem wir rechnen irgendwo riesig unsere Lieblingsformel: $z = e^{ix} = cos(x) + i sin(x)$.
	Wir erweitern sie eventuell um $r$: $re^{ix} = r(cos(x) + i sin(x))$.
	Wir wissen dass $|z|$ der Betrag der Zahl ist und können ihn ablesen aus der Angabe: $r = 4$.
	Wir wissen weiters dass $\angle z$ das Argument (der Winkel) der Zahl ist, auch diesen können wir direkt ablesen: $\varphi = 3$.
	$\Re (z)$, der Realteil von $z$ erschließt sich durch die Eulersche Formel: $\Re (e^{i3}) = r cos(3)$. Der Imaginärteil ebenso als $r sin(3)$.
	Zu guter Letzt $\overline{z}$: Dies kann einfach berechnet werden indem man $\varphi$ mit $-1$ multipliziert also $\overline{z} = 4e^{-3i}$. 
	Mittels python lässt sich all das überprüfen:
	\begin{python}{komplexe Rechnungen in python}
In [1]: %pylab
In [2]: z = 4*exp(3j)
In [3]: abs(z)
Out[3]: 4.0
In [4]: angle(z)
Out[4]: 3.0
In [5]: real(z)
Out[5]: -3.9599699864017817
In [6]: 4*cos(3)
Out[6]: -3.9599699864017817
In [7]: imag(z)
Out[7]: 0.5644800322394689
In [8]: 4*sin(3)
Out[8]: 0.5644800322394689
In [9]: conjugate(z)
Out[9]: (-3.9599699864017817-0.5644800322394689j)
In [10]: 4*exp(-3j)
Out[10]: (-3.9599699864017817-0.5644800322394689j)

	\end{python}


\end{answer}


% \subsection*{Numerische Python Befehle}
\begin{table}[H]
    \centering
    \begin{tabular}{|p{3cm}|p{6cm}|p{6cm}|}
        \hline
    \textbf{Befehl} & \textbf{Beispiel} & \textbf{Kommentar} \\ \hline
    
    \texttt{1j} & \texttt{z = 3+5j} & Die Zahl $i$. \\ \hline
    \texttt{exp()} & \texttt{z = 2*exp(1j*3)} & $e^{\cdot}$, im Bsp.: $z = 2e^{3i}$. \\ \hline
    \texttt{abs()} & \texttt{r = abs(z)} & Berechnet den Betrag von \texttt{z}. \\ \hline
    \texttt{angle()} & \texttt{phi = angle(z)} & Berechnet das Argument von \texttt{z}. \\ \hline
    \texttt{real()} & \texttt{a = real(z)} & Berechnet den Realteil \texttt{z}. \\ \hline
    \texttt{imag()} & \texttt{a = imag(z)} & Berechnet den Imaginärteil \texttt{z}. \\ \hline

    \end{tabular}
    \caption{Numerische Python Befehle bezüglich komplexer Zahlen.}
    \label{tab:pyComNumeric}
\end{table}

% \subsection*{Symbolische Python Befehle}

\begin{table}[H]
    \centering
    \begin{tabular}{|p{3cm}|p{6cm}|p{6cm}|}
        \hline
    \textbf{Befehl} & \textbf{Beispiel} & \textbf{Kommentar} \\ \hline
    \texttt{sp.Abs()} & \texttt{r = sp.Abs(z)} & Berechnet den Betrag von \texttt{z}. \\ \hline
    \texttt{sp.arg()} & \texttt{phi = sp.arg(z)} & Berechnet das Argument von \texttt{z}. \\ \hline
    \texttt{sp.re()} & \texttt{a = sp.re(z)} & Berechnet den Realteil \texttt{z}. \\ \hline
    \texttt{sp.im()} & \texttt{a = sp.im(z)} & Berechnet den Imaginärteil \texttt{z}. \\ \hline

    \end{tabular}
    \caption{Symbolische Python Befehle bezüglich komplexer Zahlen.}
    \label{tab:pyComSymb}
\end{table}


\todo[inline]{ PoleZero plot, polynome mit reellen koeefizienten -> kompl konj oder reelle nullstellen. Division von compl zahlen durch mult mit kompl. konj., $e^z$, $ln z$, python, 3d plots of complex functions}

\section{Anwendungen}\label{sec:anwendungen}

\todo[]{TODO. Fourier Transformation, Hilbert Transformation, Analytisches Signal, Modal analyse, }

\section{Aufgaben}
\begin{enumerate}
\item Lösen Sie folgende aufgabe zunächst ohne, dann nochmal mit python. Man berechne $Re(z)$, $Im(z)$, $|z|$, $arg(z)$, $\overline{z}$, $\frac{1}{z}$, $z^2$, $\frac{z}{\overline{z}}$ für folgende komplexe Zahlen $z$: $z=1+i$, $z=-3$, $z=2e^{-i\pi/3}$. (Aufgabe 4.34 aus \cite{merziger2024repetitorium})

\item Gegeben $z_1 = \alpha e^{5i}$ und $z_2 = e^{it}$ berechnen Sie (ohne und mit Python) $z_3 = z_1 \cdot z_2$. Stellen das Ergebnis in \textbf{polarer Darstellung} dar. 

\item Berechnen Sie (ohne und mit Python) Imaginärteil und Realteil von: $e^i$, $e^{i\pi}$, $e^{\pi}$. Zusatzaufgabe für den Fall $z=e^{i\pi}$: Schreiben sie auf: 'Eulersche Darstellung $=$ polare Darstellung' und betrachten Sie somit eine der 'schönsten' Formeln der Mathematik.

\item Skizzieren Sie $Im(e^{-i 2\pi x})$. (ohne und mit Python).

\item $z_1 = 4-2i$, $z_2 = 9+\frac{1}{2}i$. Berechnen Sie (ohne und mit Python): $z_1 + z_2$, $z_1 \cdot z_2$, $z_1 / z_2$, $arg(z_1)$, $|z_1|$, $arg(z_2)$, $|z_2|$.

\item $z_1 = e^{ i 2\pi 3 t}$, $z_2 = e^{ i 2\pi 5 t}$, $z_3 = e^{ i 2\pi t}$. Berechnen Sie (ohne und mit Python): $Re(z_4) = z_1 z_2 + z_3$.



\end{enumerate}


